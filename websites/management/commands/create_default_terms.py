from django.core.management.base import BaseCommand
from websites.models import Terms


class Command(BaseCommand):
    help = '建立預設的使用條款'

    def handle(self, *args, **options):
        # 檢查是否已有條款
        if Terms.objects.exists():
            self.stdout.write(
                self.style.WARNING('條款已存在，跳過建立預設條款')
            )
            return

        default_content = """# 使用條款

歡迎您使用**數據領航員 RAGPilot**（以下簡稱「本服務」）。在您註冊、使用或瀏覽本服務前，請詳細閱讀以下使用條款（以下簡稱「本條款」）。一旦您開始使用，即表示您已閱讀、理解並同意遵守本條款之所有內容。

## 一、服務內容

本服務係基於 RAG（Retrieval-Augmented Generation）技術所建構的問答與內容生成平台，提供下列功能：

- 上傳文件以進行問答摘要（支援 PDF、CSV、JSON、XML 等格式）
- 從本地資料或開放資料中進行語意查詢與檢索  
- 基於語言模型提供生成型回應與分析建議

## 二、使用者義務與承諾

- 不得利用本服務從事任何違法或侵害第三人權益之行為
- 上傳資料不得含有機密、個資、非法或違反著作權內容
- 對於使用 AI 模型所產生的內容，應自行判斷其正確性與適用性
- 如發現異常使用情形（如濫用 API、自動爬蟲、系統攻擊等），本服務有權立即終止或限制使用

## 三、智慧財產權

- 本服務所包含之介面、程式碼、商標、模型設計，均為提供者或其授權人所擁有
- 使用者上傳之合法資料仍歸使用者所有，但使用者同意授權本服務於服務運作期間內以非專屬方式使用該資料（僅限於技術處理與模型回應）
- 使用者不得重製、修改、或另行提供本服務內容予第三方使用

## 四、免責聲明

- 本服務所產生之內容係由語言模型自動生成，可能包含不正確、不完整或過時之資訊，使用者應自行判斷其可靠性
- 本服務不保證不中斷或無錯誤，亦不對因使用本服務所衍生之任何損失負責
- 本服務不適用於緊急醫療、法律或其他需高度專業判斷之場景

## 五、資料處理與隱私

- 使用者資料將依據本服務之隱私政策進行處理與保護
- 使用者上傳的檔案（如 PDF、CSV、JSON、XML 等），將被用於進行內容切割、語意向量生成與問答推論
- 本服務會透過第三方模型提供者（包含但不限於 **OpenAI** 與 **Cohere**）的 API 進行語言模型推論與向量嵌入，未來也可能新增其他服務供應商以提升處理品質
- 上述處理僅限於提供使用者查詢功能與系統優化，且不會將資料用於模型訓練或對外揭露
- 若使用者選擇刪除帳號或資料，提供者將依據合理流程處理並於【30日】內完成移除

## 六、條款變更與終止

- 本服務保留隨時修改本條款之權利，並於頁面公告更新版本
- 使用者繼續使用本服務，即視為同意修正後之條款
- 如使用者違反本條款，本服務有權停止其使用資格並刪除其資料

## 七、聯絡方式

如有任何使用相關問題，請聯繫：

- 電子郵件：[nickchen1998@gmail.com](mailto:nickchen1998@gmail.com)
- 網站連結：[https://www.ragpilot.ai](https://www.ragpilot.ai)

---

**最後更新日期：2024年12月**
"""

        # 建立預設條款
        terms = Terms.objects.create(
            title="使用條款",
            content=default_content,
            version="1.0",
            is_active=True
        )

        self.stdout.write(
            self.style.SUCCESS(f'成功建立預設條款: {terms.title} v{terms.version}')
        ) 